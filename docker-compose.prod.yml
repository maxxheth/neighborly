# Production overrides
services:
  wordpress:
    build:
      target: production
    environment:
      - WP_ENV=production
      - WP_DEBUG=false
      - WP_DEBUG_LOG=false
      - WP_DEBUG_DISPLAY=false
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 512M
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.ciwg-roots-sage-wordpress.rule=Host(`${DOMAIN}`)"
      - "traefik.http.routers.ciwg-roots-sage-wordpress.entrypoints=websecure"
      - "traefik.http.routers.ciwg-roots-sage-wordpress.tls=true"
      - "traefik.http.routers.ciwg-roots-sage-wordpress.tls.certresolver=letsencrypt"
      - "traefik.http.services.ciwg-roots-sage-wordpress.loadbalancer.server.port=80"
      - "traefik.docker.network=web"

  mysql:
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
  # Node container is not needed in production
  # Assets are pre-built during the Docker build
